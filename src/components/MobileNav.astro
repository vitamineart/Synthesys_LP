---
export interface Props {
  currentPage?: string;
}

const { currentPage = 'home' } = Astro.props;

// Import navigation and social data
import navData from '../../public/data/navigation.json';
import socialData from '../../public/data/social.json';
---

<div class="lg:hidden fixed z-50 left-0 top-0 bottom-0 right-20 sm:right-1/4 md:right-1/3 transition-transform ease-in-out duration-500 bg-green min-h-full -translate-x-full overflow-auto py-1" id="mobile-nav-container">
  <button type="button" id="mobile-nav-close" class="origin-center inline-block w-4 h-4 mt-6 ml-6 hover:opacity-60 transition-all text-transparent">
    <svg class="w-5 h-5 inline-block stroke-black stroke-2">
      <use xlink:href="/icons/close.svg"></use>
    </svg>
  </button>

  <nav id="mobile-nav" class="w-7/12 mx-auto flex flex-col justify-center items-center">
    <a href="/" class="mt-10 text-black">
      <svg class="w-44 h-11 fill-current">
        <use xlink:href="/icons/sprite.svg#logo-mono"></use>
      </svg>
    </a>

    <menu class="flex flex-col justify-center items-center space-y-10 mt-20 main-nav">
      {navData.map((item) => (
        <a
          href={item.href}
          class={`text-black after:bg-white after:w-1 after:h-1 after:rounded-full after:inline-block after:mt-1 after:absolute after:top-full after:left-1/2 relative hover:text-bodycopy-darker text-lg font-semibold transition-colors duration-300 ${currentPage === item.page ? 'active' : ''}`}
        >
          {item.labelMobile}
        </a>
      ))}
    </menu>

    <a href="https://app.synthesys.io/" class="login border-3 text-lg font-semibold w-full max-w-xs text-center text-black border-white py-2 px-10 mt-20 hover:border-bodycopy transition-colors duration-300">
      Login
    </a>

    <div class="mt-11 pt-11 border-t border-black/20 text-black">
      <div class="social-share flex space-x-3 lg:space-x-4">
        {socialData.map((social) => (
          <a href={social.url} class="w-10 h-10 grid place-items-center border-2 p-2 rounded-full transition-colors border-dark-blue/10 hover:border-white">
            <svg class="w-3 h-3 fill-current">
              <use xlink:href={`/icons/sprite.svg#icon-${social.icon}`}></use>
            </svg>
          </a>
        ))}
      </div>
    </div>
  </nav>
</div>

<script>
  // Mobile Navigation - Client-side JavaScript Island
  document.addEventListener('DOMContentLoaded', function() {
    const mobileNavToggle = document.getElementById('mobile-nav-toggle');
    const mobileNavClose = document.getElementById('mobile-nav-close');
    const mobileNavContainer = document.getElementById('mobile-nav-container');
    const body = document.body;

    function openMobileNav() {
      if (mobileNavContainer) {
        mobileNavContainer.classList.remove('-translate-x-full');
        body.classList.add('overflow-hidden');
      }
    }

    function closeMobileNav() {
      if (mobileNavContainer) {
        mobileNavContainer.classList.add('-translate-x-full');
        body.classList.remove('overflow-hidden');
      }
    }

    // Event listeners
    if (mobileNavToggle) {
      mobileNavToggle.addEventListener('click', openMobileNav);
    }

    if (mobileNavClose) {
      mobileNavClose.addEventListener('click', closeMobileNav);
    }

    // Close mobile nav when clicking outside
    if (mobileNavContainer) {
      mobileNavContainer.addEventListener('click', function(event) {
        if (event.target === mobileNavContainer) {
          closeMobileNav();
        }
      });
    }

    // Close mobile nav on escape key
    document.addEventListener('keydown', function(event) {
      if (event.key === 'Escape') {
        closeMobileNav();
      }
    });
  });
</script>
